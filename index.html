<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Chore Chart</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{--bg:#0b1220;--card:#0f1830;--accent:#ffb86b;--accent2:#7ce3ff;--muted:#9aa6c3;--good:#6ee7a6;--bad:#ff6b6b}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:#fff;font-family:system-ui,-apple-system,sans-serif;height:100vh;display:flex;flex-direction:column}
#app{flex:1;display:flex;flex-direction:column;padding:12px 16px}

/* === YOUR ORIGINAL HEADER === */
.header{display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:12px}
.title{font-size:22px;font-weight:900;color:var(--accent2)}
.subtitle{font-size:13px;color:var(--muted);margin-top:4px}

/* === HUGE CLOCK – ONLY CHANGE #1 === */
.bigClock{margin:20px 0 30px;text-align:center;padding:20px;background:rgba(255,255,255,0.06);border-radius:24px}
.bigDay{font-size:44px;font-weight:900;color:var(--accent2)}
.bigTime{font-size:80px;font-weight:900;color:var(--accent);letter-spacing:4px;margin-top:-10px}
@media(max-width:700px){.bigDay{font-size:34px}.bigTime{font-size:60px}}

/* === FOCUS BUTTONS – ONLY CHANGE #2 === */
.focusSwitcher{display:flex;justify-content:center;gap:20px;margin:20px 0;flex-wrap:wrap}
.focusBtn{padding:18px 36px;font-size:22px;font-weight:900;border-radius:30px;background:rgba(255,255,255,0.1);color:var(--muted);border:none;cursor:pointer;min-width:180px;transition:all .3s}
.focusBtn.active{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#000;transform:scale(1.1);box-shadow:0 10px 30px rgba(255,184,107,0.5)}
.focusBtn:hover:not(.active){background:rgba(255,255,255,0.2);transform:translateY(-4px)}

/* === YOUR ORIGINAL STYLES (unchanged) === */
.container{flex:1;display:flex;gap:16px}
.column{flex:1;background:rgba(255,255,255,0.03);border-radius:16px;padding:16px;display:flex;flex-direction:column}
.kidHead{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.kidAvatar{width:60px;height:60px;border-radius:16px;background:linear-gradient(135deg,var(--accent2),#ffd27a);display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:900;color:#000}
.kidName{font-size:20px;font-weight:800}
.taskList{flex:1;overflow-y:auto;padding-right:8px}
.card{background:var(--card);border-radius:14px;padding:16px;margin-bottom:12px;cursor:pointer;transition:.2s}
.card:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(0,0,0,0.4)}
.cardDone{opacity:0.7;border-left:6px solid var(--good)}
.star{font-size:28px;margin-right:12px}
.taskTitle{font-size:18px;font-weight:700}
.taskMeta{font-size:13px;color:var(--muted);margin-top:4px}
.addTaskBtn{margin-top:12px;padding:10px;background:rgba(255,255,255,0.1);border:none;border-radius:12px;color:var(--muted);cursor:pointer}
.progress{margin-top:8px;height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden}
.progressInner{height:100%;background:var(--good);width:0%;transition:width .4s}
.controls button{padding:10px 16px;border:none;border-radius:12px;background:var(--accent);color:#000;font-weight:700;cursor:pointer}
@media(max-width:900px){.container{flex-direction:column}}
</style>
</head>
<body>

<div id="app">
  <div class="header">
    <div>
      <div class="title">Chore Chart</div>
      <div class="subtitle">David & Daxel — Daily Tasks</div>
    </div>
    <div class="controls">
      <button id="resetBtn">Reset Day</button>
      <button id="statsBtn">Stats</button>
    </div>
  </div>

  <!-- HUGE CLOCK -->
  <div class="bigClock">
    <div id="dayLabel" class="bigDay"></div>
    <div id="clockLabel" class="bigTime"></div>
  </div>

  <!-- FOCUS BUTTONS -->
  <div class="focusSwitcher">
    <button class="focusBtn active" data-kid="both">Both Kids</button>
    <button class="focusBtn" data-kid="David">Only David</button>
    <button class="focusBtn" data-kid="Daxel">Only Daxel</button>
  </div>

  <div class="container" id="mainContainer">
    <!-- DAVID -->
    <div class="column" id="colDavid">
      <div class="kidHead">
        <div class="kidAvatar">D</div>
        <div>
          <div class="kidName">David <span id="xpDavid">0 XP</span></div>
          <div style="font-size:13px;color:var(--muted)">Streak: <span id="streakDavid">0</span> days</div>
        </div>
      </div>
      <div class="taskList" id="listDavid"></div>
      <div class="progress"><div class="progressInner" id="progDavid"></div></div>
      <button class="addTaskBtn" data-kid="David">+ Add Task</button>
    </div>

    <!-- DAXEL -->
    <div class="column" id="colDaxel">
      <div class="kidHead">
        <div class="kidAvatar">X</div>
        <div>
          <div class="kidName">Daxel <span id="xpDaxel">0 XP</span></div>
          <div style="font-size:13px;color:var(--muted)">Streak: <span id="streakDaxel">0</span> days</div>
        </div>
      </div>
      <div class="taskList" id="listDaxel"></div>
      <div class="progress"><div class="progressInner" id="progDaxel"></div></div>
      <button class="addTaskBtn" data-kid="Daxel">+ Add Task</button>
    </div>
  </div>
</div>

<script>
// FIXED BACKEND URL
const SERVER_STATE_URL = 'https://chore-backend-production.up.railway.app/api/chore-state';
const STORAGE_KEY = "CHORE_CHART_V8";

// === CLOCK ===
function updateClock() {
  const now = new Date();
  document.getElementById("dayLabel").textContent = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][now.getDay()];
  document.getElementById("clockLabel").textContent = now.toLocaleTimeString([], {hour:'numeric', minute:'2-digit'});
}
setInterval(updateClock, 1000);
updateClock();

// === FOCUS BUTTONS LOGIC ===
document.querySelectorAll(".focusBtn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".focusBtn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const mode = btn.dataset.kid;
    document.querySelectorAll(".column").forEach(col => {
      col.style.display = (mode === "both" || col.id === "col" + mode) ? "flex" : "none";
    });
  });
});

// === YOUR ORIGINAL SCRIPT (unchanged) ===
let state = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
if (!state.tasks) state.tasks = {David: [], Daxel: []};

async function save() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  try { await fetch(SERVER_STATE_URL, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(state)}); }
  catch(e){console.log("save failed",e);}
}
async function load() {
  try {
    const r = await fetch(SERVER_STATE_URL);
    if (r.ok) state = {...state, ...(await r.json())};
  } catch(e){}
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  render();
}
function render() {
  ["David","Daxel"].forEach(kid => {
    const list = document.getElementById(`list${kid}`);
    list.innerHTML = "";
    state.tasks[kid].forEach(t => {
      const div = document.createElement("div");
      div.className = "card" + (t.done?" cardDone":"");
      div.innerHTML = `<div class="star">⭐</div>
        <div class="taskTitle">${t.text}</div>
        ${t.minutes?`<div class="taskMeta">${t.minutes} min</div>`:""}`;
      div.onclick = () => { t.done = !t.done; save(); render(); };
      list.appendChild(div);
    });
    const done = state.tasks[kid].filter(t=>t.done).length;
    const total = state.tasks[kid].length;
    document.getElementById(`prog${kid}`).style.width = total? (done/total*100)+"%":"0%";
    document.getElementById(`xp${kid}`).textContent = (state.xp?.[kid]||0) + " XP";
    document.getElementById(`streak${kid}`).textContent = state.streak?.[kid]||0;
  });
}
document.querySelectorAll(".addTaskBtn").forEach(b => b.onclick = () => {
  const kid = b.dataset.kid;
  const text = prompt("Task name?");
  if (text) {
    state.tasks[kid].push({text, done:false});
    save();
  }
});
document.getElementById("resetBtn").onclick = () => {
  if (confirm("Reset all tasks today?")) {
    ["David","Daxel"].forEach(k => state.tasks[k].forEach(t=>t.done=false));
    save();
  }
};

load();
</script>
</body>
</html>
